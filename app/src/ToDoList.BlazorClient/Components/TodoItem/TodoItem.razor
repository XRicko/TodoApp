<li class="list-group-item">
    <div class="d-flex flex-column">
        <div class="d-flex">
            <div class="form-check">
                <input class="form-check-input"
                       id="@TodoItemModel.Id"
                       @onchange="async (args) => await OnStatusChangeCallback.InvokeAsync(new ChangeTodoItemStatusArgs(TodoItemModel, args))"
                       type="checkbox"
                       checked="@IsChecked" />
                <label class="form-check-label" for="@TodoItemModel.Id">&nbsp;</label>
            </div>

            <div>
                @TodoItemModel.Name

                <Badges StatusName="@TodoItemModel.StatusName"
                        CategoryName="@TodoItemModel.CategoryName"
                        OnCategoryCallback="async () => await OnFilterByCategoryCallback.InvokeAsync(
                                                new FilterTodoItemsArgs(FilterTodoItemsArgs.StatusName, TodoItemModel.CategoryName))"
                        OnStatusCallback="async () => await OnFilterByStatusCallback.InvokeAsync(
                                              new FilterTodoItemsArgs(TodoItemModel.StatusName, FilterTodoItemsArgs.CategoryName))" />
            </div>
        </div>

        <a href="http://maps.google.com/?q=@TodoItemModel.Address" target="_blank">@TodoItemModel.Address</a>

        @if (TodoItemModel.ImageContent is not null)
        {
            <img src="data:image;base64,@Convert.ToBase64String(TodoItemModel.ImageContent)"
                 class="img-fluid align-self-center"
                 style="max-width: 400px; width: 100%" />
        }

        <div class="d-flex justify-content-between align-items-center">
            <div class="text-muted">
                @TodoItemModel.DaysAgo Days ago
            </div>

            <div>
                <form method="post"
                      @onsubmit="async () => await OnDeleteCallback.InvokeAsync(TodoItemModel)"
                      class="d-inline">

                    <button type="submit"
                            class="border-0 btn-transition btn btn-outline-danger">
                        <i class="oi oi-trash"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>
</li>

@code {
    [Parameter]
    public TodoItemModel TodoItemModel { get; set; }

    [Parameter]
    public EventCallback<TodoItemModel> OnDeleteCallback { get; set; }

    [Parameter]
    public EventCallback<ChangeTodoItemStatusArgs> OnStatusChangeCallback { get; set; }

    [CascadingParameter(Name = "FilterByCategory")]
    public EventCallback<FilterTodoItemsArgs> OnFilterByCategoryCallback { get; set; }

    [CascadingParameter(Name = "FilterByStatus")]
    public EventCallback<FilterTodoItemsArgs> OnFilterByStatusCallback { get; set; }

    [CascadingParameter]
    public FilterTodoItemsArgs FilterTodoItemsArgs { get; set; }

    private bool IsChecked => TodoItemModel.StatusName.Equals("Done");
}
