@inject IApiInvoker ApiInvoker


@foreach (var todoItem in TodoItemModels)
{
    <TodoItem TodoItemModel="todoItem"
              OnDeleteCallback="DeleteTodoItem"
              OnStatusChangeCallback="OnStatusChange" />
}

@code {
    [CascadingParameter]
    private IModalService Modal { get; set; }

    [Parameter]
    public List<TodoItemModel> TodoItemModels { get; set; } = new();

    private async Task DeleteTodoItem(TodoItemModel todoItemModel)
    {
        var result = await Modal.Show<Confirm>("Confirmation").Result;

        if (result.Cancelled)
            return;

        await ApiInvoker.DeleteItemAsync("TodoItems/", todoItemModel.Id);
        TodoItemModels.Remove(todoItemModel);
    }

    [Parameter]
    public EventCallback<ChangeTodoItemStatusArgs> OnStatusChange { get; set; }
}
